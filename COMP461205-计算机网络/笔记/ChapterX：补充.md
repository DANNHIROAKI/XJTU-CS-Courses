## 3.7. 广域网

> ### 3.7.2. PPP协议：面向字节的协议
>
> > #### 3.7.2.1. PPP组成部分
> >
> > > :one:将IP数据报封装到串行链路的方法
> > >
> > > :two:链路控制协议(LCP)：建立/配置/测试/释放(空闲时)数据链路连接
> > >
> > > :three:网络控制协议(NCP)：一串协议总称，每个协议支持不同网络层协议，建立/配置不同网络层协议
> >
> > #### 3.7.2.1. PPP帧格式
> >
> > > <img src="https://raw.githubusercontent.com/DANNHIROAKI/PicGo-Typora-GitHub-Picture-bed/main/img/image-20231005173344632.png" alt="image-20231005173344632" style="zoom:67%;" /> 
> > >
> > > :one:标志字段：首尾(尾也要加因为无间隙)各占一字节，内容为0111 1110(0x7E)，为实现透明传输(防止中间出现标志字段而终止)，采用**字节填充**，如下
> > >
> > > 1. 把信息字段中的0x7E转变为0x7D+0x5E
> > >
> > > 2. 把信息字段中的0x7D转变为0x7D+0x5D
> > >
> > > 3. 把信息字段中的ASCII控制符(小于0x20)前加入一个0x7D，然后将这个字符加上0x20
> > >
> > >    例如将0x03转化为0x7D+0x23
> > >
> > > :two:地址字段(规定为0xFF)，控制字段(规定为0x03)
> > >
> > > :three:协议字段：占两字节，例如部分内容和含义为
> > >
> > > 1. 0x0021，PPP帧的信息字段是IP 
> > >
> > > 2. 0xC021，PPP帧的信息字段是PPP链路控制数据
> > > 3. 0x8021，PPP帧的信息字段是网络控制数据
> > >
> > > :four:信息部分：1-1500B，点对点传输，不采用CSMA/CD协议(因为不是总线型)
> > >
> > > :five:帧检验序列：两字节，循环冗余码检验中的冗余码
> >
> > #### 3.7.2.2. PPP的工作状态
> >
> > > :one:用户拨号接入ISP，调制解调器确认拨号，建立一条物理连接
> > >
> > > :two:PC向路由器发送一系列LCP分组(封装成PPP帧)
> > >
> > > :three:网络控制协议(NCP)给新接入PC一个临时IP，PC就成为一个主机了
> > >
> > > :four:通讯完毕：NCP释放网络层连接，LCP释放链路层连接，物理层连接也释放
> >
> > #### 3.7.2.3. PPP不具备的功能
> >
> > > 只检错不纠错，流量控制由TCP完成，不需要给帧编号(反之于HDLC)，只能点对点不能多点线路，只支持全双工
>
> ### 3.7.3. HDLC协议：实现数据链路的可靠传输
>
> > #### 3.7.3.1. 概述 
> >
> > >  :one:ISO制定的，面向比特的数据链路控制协议
> > >
> > >  :two:分为非平衡配置(一个主站控制整个链路)，平衡配置(链路两端的复合站平等发起传输，不用对方确认)
> >
> > #### 3.7.3.2. 帧格式
> >
> > > <img src="https://raw.githubusercontent.com/DANNHIROAKI/PicGo-Typora-GitHub-Picture-bed/main/img/image-20231005190056397.png" alt="image-20231005190056397" style="zoom: 25%;" />   
> > >
> > > HDLC的数据Info来自网络层交下来的分组，数据链路层再在消息头尾各加24位控制信息
> > >
> > > :one:标志字段：0111 1110，**比特填充**的首尾标志法，当比特流无控制信息时扫描帧，五个1就往后面加0
> > >
> > > :two:地址字段：为次站地址(非平衡方式传)or确认站的地址(平衡方式)，全1为广播，全0无效
> > >
> > > :three:控制字段：可将HDLC帧划分为信息帧(传数据)/监督帧(流量or差错控制or确认重发)/无编号帧(拆建链路)
> > >
> > > :four:FCS：即循环冗余码检验中的冗余码，检验区间包括地址字段、控制字段和信息字段