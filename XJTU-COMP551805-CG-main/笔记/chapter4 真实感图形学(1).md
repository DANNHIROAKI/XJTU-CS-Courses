[TOC]

# 【XJTUSE计算机图形学】第四章 真实感图形学(1)——–颜色视觉

生成三维场景的真实图形的步骤：

> :one: 建立景物的几何模型；
>
> :two: 进行取景变换和透视变换；
>
> :three: 进行消隐处理；
>
> :four: 进行真实感图形绘制。

真实感图形学：

> 研究如何用计算机生成三维场景的真实感图形图像。
>
> 根据假定的光照条件和景物外观因素，依据一定的光照模型，计算可见面投射到观察者眼中的光强度大小，并将它转换成适合图形设备的颜色值，生成投影画面上每一个象素的光强度，使观察者产生身临其境的感觉。

应用：

> 真实产品外形设计；
>
> 飞行驾驶模拟训练；
>
> 动画制作、城市规划、医学气象等。

特点：

> 表现物体质感；
>
> 真实反映物体表面颜色和亮度；
>
> 能模拟透明物体的透明效果和镜面物体的镜像效果；
>
> 能通过光照下物体的阴影，改善场景的深度感和层次感。

影响真实感图形的因素:

> 真实物体本身形状；
>
> 物体表面特征：材质、感光度和纹理等；
>
> 照射物体的光源；
>
> 物体与光源相对位置；
>
> 物体周围环境。

## 真实感图形学

如已知场景的光照明效果的物理**模型**，则可用计算机模拟真实世界。

观察者对图像光函数的亮度响应，通常采用光场的瞬时光亮度计量：

![image-20220215165948574](https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215165948574.png)

$I(x,y,t,\lambda)$表示成像**平面的空间辐射能量**；

$V_s(\lambda)$代表相对光效函数，即人视觉的光谱响应。

生成具有真实感的图像，关键在于$I$的计算：核心在于如何仿真光源发出的光线在物体间的传播的照明效果包括**反射**、**透射**、**折射**、**表面纹理**和**阴影**等。

**光照明模型**：已知物体物理形态和光源性质的条件下，能计算出场景光照明效果的数学模型。

> 可以用描述物体表面光强度的物理公式推导出来；
>
> 实用价值模型：实际光照效果的不同层次的简化；
>
> 早期模型(基于经验)：只反映光源直接照射的情况；
>
> 精确的模型：模拟物体之间光的相互作用。

## 颜色视觉

要产生具有高度真实感的图像，颜色是最重要的因素。

颜色是外来的光刺激作用于人的视觉器官而产生的主观感觉，影响的因素有：

> 物体本身；
>
> 光源；
>
> 周围环境；
>
> 观察者的视觉系统。

### 基本概念

#### 光源(了解)

**点光源**，如果光源大小比场景中的物体小得多，可以假定光线是从一个点向四周均匀发散的，最简单的模型。

**线光源**，可以看作是多个点光源在一维空间上的合成，例如模拟荧光灯管这类长条形的光源。

**面光源**，即可以看作线光源在高一维空间的合成，也可看作点光源在二维空间的合成。它可以用来模拟发光的块状物体。

#### 颜色类型

非彩色：黑色、白色和各种不同深浅的灰色；

彩色：指黑白系列以外的各种颜色

#### 颜色的属性

非彩色只有一个属性：明度（图）

彩色具有三属性：（常称颜色的心理三属性）

#### <mark>颜色的三个视觉特性(心理学属性）</mark>——HSV

**色调(Hue) ；**

**饱和度(Saturation) ；**

**亮度(Value)。**

#### <mark>颜色的物理特性</mark>

**主波长（Dominant Wavelength)**：产生颜色光的波长，对应于视觉感知的色调；

**纯度(Purity)**：对应于饱和度；

**明度(Luminance)**：对应于光的亮度。

#### 色调

一种颜色区别于其他颜色的因素

单色光：对应着它的波长；

复色光：比例最大的单色光的波长（主波长）；

人眼可分辨的光谱色有100多种，谱外色30多种，共计130多种。

#### 色调环

同类色：相距15°以内；

邻近色：相距15°～45°以内；

对比色：位于100°～197°之间；

互补色：相距180°。

<img src="https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215170946067.png" alt="image-20220215170946067" style="zoom:67%;" />

#### 辨认阈限

人的视觉在辨认波长的微小变化方面的能力。

![image-20220215171014127](https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215171014127.png)

在可见光谱的两端，人眼对波长变化的反应能力近乎迟钝，特别是在波长大于655nm及小于430nm的区域，人眼几乎无法分辨颜色上的差别。

#### 亮度

人眼所能感受到色彩的明暗程度，是与人的心理、生理有关的一个属性。

单色光:光线越强，其色彩越明亮；

物体表面的光辐射率越高，亮度越高；发光体的明度越高，亮度越高。

白颜料是反射率极高的物质：如果在其它颜料中加入白色，可以提高混合色的亮度；加入黑色，可以降低混合色的亮度。

#### 饱和度

颜色的纯度

单色光的饱和度最高；

复色光的波长范围越窄，光色越饱和；

色料中含灰分的比例低，则其饱和度高；

物体色饱和度取决于表面反射光谱色的选择性

![image-20220215171117556](https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215171117556.png)

#### 颜色三属性的相互关系

**色调**：色刺激的光谱组成及光谱功率分布峰值的位置；

**亮度**：色刺激的光强；

**饱和度**：最强波长的功率对其它波长占优势的程度；

三者相互独立的但并不单独存在，其变化是相互联系、影响的

**两者**只有在适当**亮度**下才能充分表现出来。

#### 颜色纺锤体

颜色三特性的空间表示：

> 垂直轴线表示白黑亮度变化；
>
> 水平圆周上的不同角度点代表了不同色调的颜色；
>
> 从圆心向圆周过渡表示同一色调下饱和度的提高

![image-20220215171251934](https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215171251934.png)

平面圆形上的色调和饱和度不同，而亮度相同

#### 光的物理知识

光是人的视觉系统能够感知到的电磁波

> 波长在400nm到700nm之间 (1nm=10^-9m)。

光可以由它的光谱能量分布$P(\lambda)$来表示

> 白：各种波长的能量大致相等；
>
> 彩色：各波长的能量分布不均匀；
>
> 单色：包含一种波长的能量，其他波长都为零。

能否用光谱能量的分布定义颜色? **不能**

**异谱同色**：**两种光的光谱分布不同而颜色相同的现象**

> <mark>光谱与颜色的对应关系是多对一；</mark>
>
> 须采用其他的定义颜色的方法，使光本身与颜色一一对应。

### 颜色视觉理论

颜色视觉是真实感图形学的生理基础，**颜色**科学中最基本、最重要的理论。

> **恒常性**：根据物体固有的颜色来感知它们，不受外界条件变化的影响。
>
> > 煤是黑的，雪是白的
>
> **混合性**：太阳光通过棱镜后分散成光谱上的颜色光带，证明白光由很多颜色光混合而成。

颜色视觉理论：**三色学说**；**四色学说（对立颜色学说）**；**现代阶段学说**。

#### 三色学说

三色学说的形成：

> Yaung提出某种波长的**光可以通过三种不同波长的光混合而复现出来**的假说:
>
> > 把三种原色按照不同的比例混合就能准确的复现其他任何波长的光；三原色等量混合产生白光。
>
> Maxwell用旋转圆盘证实了Yaung假设。
>
> 1862年，Helmhotz提出三色学说。

**三色原理**：用三种原色能够产生各种颜色

> 当今颜色科学中最重要的原理和学说；
>
> **RGB颜色模型提出的理论基础。**

**(近代)三色学说**

视网膜上含有三种不同类型的锥体细胞，分别含有感**红、绿和蓝**三种视色素，具有各自的光谱吸收率；

![image-20220215171804245](https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215171804245.png)

三种色素按各自的吸收特性吸收外界光辐射后，产生光化学反应，刺激视神经，通过神经中枢传递给大脑产生综合颜色感觉。

三色学说解析：

> **现代解剖学**证实了视锥细胞分为红视锥细胞、绿视锥细胞与蓝视锥细胞。
>
> **彩色感觉**：感红色素兴奋时产生红色感觉，感红感绿色素同时兴奋时，大脑产生黄色感觉，两者按比例变化产生橙色或黄绿感觉。
>
> **白色和灰色**：三种锥体细胞受到等量刺激时产生自灰到白的感觉。
>
> **杆状细胞**：只含一种紫红色素，只有明暗感觉，不能分辨颜色。

**三色学说**

> **能解释负后像现象**：当眼睛长时间注视某个颜色样品后，撤去该颜色样品的瞬间，在原来样品的位置上会出现于样品颜色互补的颜色感觉，再过一段时间后这个互补的颜色感觉逐渐消失。（红-白）
>
> **不能解释色盲**
>
> > 应有三种色盲：红色盲、绿色盲和蓝色盲，且单独存在。但几乎所有的红色盲也是绿色盲也即红绿色盲；
> >
> > 只有三种感色神经同时兴奋时，才能产生白色与灰色的感觉，色盲者不应该看到白色或灰色；
> >
> > 红绿色盲不应该看到红与绿的混合色即黄色。

#### 四色学说

1864年由赫林提出，颜色对立学说**。**

**四种心理原色**：红、绿、黄、蓝。其它色由这四色混合而成，这四色中的任何一个都不能**由其它色混合得到**。

**三对独立视色素**：红-绿、黄-蓝、黑-白。它们的代谢作用包括建设（同化）和破坏（异化）两种对立的过程。红和绿视色素组合只能得到灰色或白色感觉，即绿刺激抵消红刺激的作用。

![image-20220215172326251](https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215172326251.png)

**解释颜色混合现象**：当两种颜色为对立色时，混合时得到白色，这是因为它们对某一对视素的两种对立过程形成平衡的结果。

**能解释负后像现象**：当某一色彩刺激停止时，与该色彩相关的视素的对立过程开始活动，因而产生该颜色对立色，即补色。

**解释色盲现象**：色盲是缺乏一对或两对视色素的结果。即使缺乏两对视色素，导致全色盲，仍然有黑白视色素，有黑白感觉。

**不能解释近代色度学基础**：即不能说明三原色能混合一切色的现象。

#### 现代阶段学说

将颜色视觉的形成分为**两个阶段**

> **视网膜阶段**：在视网膜中存在三种感色的锥体细胞，每种具有不同的光谱敏感特性和单独产生黑白反应。
>
> **视神经传输阶段**：在视觉信息由锥体细胞向大脑的传导过程中，红、绿、蓝反应变成三对独立的神经反应：黑-白、红-绿、黄-蓝，即四色机制。
>
> ![image-20220215172628404](https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215172628404.png)

**优点**：统一了三色和四色学说。视网膜阶段解释三色学说，视神经传输阶段解释四色学说。

#### 色光混合定律

1854年H.Grassman总结出颜色混合的基本规律，**格拉斯曼**定律。

人的视觉只能分辨颜色的三种变化：明度、色调、饱和度；

在由两个成份组成的混合色中，如果一个成份连续变化，混合色的外貌也连续变化。导出补色律和中间色律。

> **补色律**：只要一种色光与另一种色光混合能产生白光，这两种色光就是互补色。
>
> **中间色律**：任何两个非互补色混合，便产生中间色，其色调靠近比例较大的色光。
>
> ![image-20220215172916848](https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215172916848.png)

**等效率**：外貌相同的色光，无论它们的光谱组成是否一样，在颜色混合中具有相同的效果。导出

**亮度相加定律**：混合色光的总亮度等于组成混合色的各颜色光亮度的总和。

**代替律**

> 两个相同的颜色与另外两个相同的颜色相加混合后，颜色仍然相同：
>
> *A* ≡ *B*， *C* ≡ *D*
>
> *A* ＋*C* ≡ *B* ＋ *D*
>
> 两个相同的颜色每个减去相同的颜色，余下的颜色仍然相同：
>
> *A* －*C* ≡ *B* － *D*
>
> 两个相同的颜色，同时扩大或缩小相同倍数后，两颜色仍相同
>
> n*A* ≡ n*B*

颜色混合三定律：**补色律、中间色律、代替律**统称为颜色混合三定律。

**加色法混合**：混合色的光谱能量分布是每个组成色的光谱能量分布的简单相加，故称为色光相加混合。

> 三原色光：红光、绿光、蓝光。

**减色法混合**：

> 色料：涂染后能够使无色的物体呈色、有色物体改变颜色的物质；
>
> 色料三原色：青、品红、黄；
>
> 混合色为光源光谱成份减去被色料吸收的光谱成份后所剩余的光谱成份引起的颜色视觉。

#### 几种颜色视觉现象

**恒常性**：外界条件发生一定范围的变化后，视觉对物体的颜色感觉仍保持相对稳定的特性；

**适应性**：由于环境光对眼睛的持续作用，致使眼睛对环境光产生一定的抵消作用，而使颜色视觉发生变化的现象；（负后像）

**对比性**：眼睛同时接受相邻不同颜色的刺激，造成颜色视觉发生变化的现象。

### CIE色度图(了解)

CIE：国际照明委员会

三色学说解释了颜色混合现象：任何颜色可用红、绿、蓝按照不同比例混合来得到。

颜色匹配-如何由三原色混合复现给定颜色？

CIE选取标准红、绿和蓝(700, 546, 435.8)。

光的颜色匹配式子：
$$
c=rR+gG+bB
$$
权值*r**、**g**、**b*为颜色匹配中所需要的三色光的相对量（三刺激的值）

#### RGB系统

1931年CIE给出等能标准三原色匹配任意颜色的光谱三刺激值曲线。(CIE-RGB系统)

![image-20220215173747105](https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215173747105.png)

CIE-RGB曲线**一部分三刺激值是负数**：

> 在给定的光上叠加曲线中负值对应的原色，来匹配另外两种原色的混合；
>
> 不能单靠混合RGB来匹配对应的光。

#### XYZ系统

1931年CIE规定了三种假想的标准原色(X, Y, Z)，构造了CIE-XYZ系统

颜色匹配函数的三刺激值为正值。

![image-20220215173826168](https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215173826168.png)

CIE-XYZ系统的光颜色匹配函数的定义如下：
$$
c=rX+gY+bZ
$$
任何颜色都能由标准三原色混合匹配；

解决了颜色匹配问题。

#### 色度图

三维颜色空间：由三原色的单位向量所定义

> 三刺激空间：一个颜色刺激可表示为三维空间中的一个以原点为起点的**向量**
>
> 为了在二维空间中表示颜色，在三维坐标轴上对称的取一个截面，该截面通过三个坐标轴上的单位向量
>
>  (X)+(Y)+(Z)=1

**CIE-XYZ系统**

色度图：截面与三个坐标平面的交线构成一个等边三角形。

颜色（刺激向量）与色度图有唯一交点，空间坐标(x,y,z)表示为该颜色在标准原色下的三刺激值，称为色度值：

<img src="https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215174048564.png" alt="image-20220215174048564" style="zoom:80%;" />

![image-20220215174058075](https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215174058075.png)

两个独立变量，可进行投影。

翼形轮廓线代表所有可见光波长的轨迹，即可见光谱曲线。

沿线的数字表示该位置的可见光的主波长。

中央的C对应于近似太阳光的标准白光，C点接近于但不等于x=y=z=1/3的点。

红色区域位于图的右下角，…,连接光谱轨迹两端点的直线称为紫色线。

![image-20220215174115338](https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215174115338.png)

**CIE色度图用途**

> **获得互补色**：从该颜色点过C点作一条直线，可得到补色的波长。
>
> **确定所选颜色的主波长和纯度**：
>
> > A点：过点C作直线与光谱曲线相交于B，颜色A可表示为纯色光B和白光C的混合，B就定义了颜色A的主波长；
> >
> > F点：如交点在紫色线上，用其补色(B)的波长加后缀c表示。
>
> **定义一个颜色域**：通过调整混合比例，任意两种颜色。
>
> I和J加在一起能够产生它们连线上的颜色。
>
> 加入第三种颜色K，就产生三者构成的三角形区域的颜色。
>
> ![image-20220215174227168](https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215174227168.png)

应用较复杂，需要引入其它颜色系统-颜色模型

### 常用颜色模型

颜色模型：某个三维颜色空间中的一个可见光子集，包含某个颜色域的所有颜色：

> 用途：在某个颜色域内方便地指定颜色；
>
> 在某种特定环境中对颜色的特性和行为的解释方法；
>
> <mark>**没有一种颜色模型能解释所有的颜色问题**</mark>，可使用不同模型帮助说明所看到各种颜色特征。

<mark>**常用的颜色模型**</mark>

> 彩色CRT显示器：**RGB模型**。
>
> 印刷行业：**CMY模型**。
>
> 面向用户的模型：以易用性为目的，为用户提供更直觉的颜色参数，例如**HSV模型。**
>
> 用于彩色广播电视系统的模型：
>
> > YUV模型用于PAL制式的电视系统；
> >
> > YIQ模型用于NTSC制式的电视系统；
> >
> > YCbCr模型由YUV颜色模型派生而来，主要用于数字电视系统中。

#### 两种原色混合系统

基于Red、Green和Blue三原色定义**RGB加色系统**；

基于青（Cyan）、品红（Magenta）和黄（Yellow）**CMY减色系统**；

**两种系统的颜色互为补色**：青-红、品红-绿、黄-蓝，习惯上把红绿蓝作为原色

![image-20220215174702033](https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215174702033.png)

#### RGB颜色模型

基于红绿蓝三原色定义加色系统；

采用三维直角坐标系，RGB立方体；

每个彩色点采用(R,G,B)表示，[0,1]或[0，255]。

所覆盖的颜色域取决于显示设备荧光点的颜色特性，与其它硬件无关。

<img src="https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215175155963.png" alt="image-20220215175155963" style="zoom:67%;" />

#### CMY颜色模型

基于**青、品红、黄**的减色系统；

常用于从白光中滤去某种颜色；

对RGB模型的直角坐标系的子空间作下述变换即可获得CMY颜色模型直角坐标系的子空间：

C=1-R、M=1-G、Y=1-B

![image-20220215175355951](https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215175355951.png)

印刷硬拷贝设备的颜色处理：在白纸面上涂黄色和品红色，纸面上将呈现红色, 因为白光被吸收了蓝光和绿光，只能反射红光

RGB颜色模型与CMY颜色模型都是面向硬件模型。

#### HSV颜色模型

HSV**（**Hue Saturation Value）颜色模型是面向用户模型，该模型对应于圆锥形：

圆锥的顶面对应于V=1（亮度）

色度H由绕V轴的旋转角给定

饱和度S取值从0到1，由圆心向圆周过渡。

> 顶面包含RGB模型中三个面；
>
> 纯色：最大顶面圆；
>
> 圆锥顶点，H，S无定义；
>
> 圆锥顶面中心H无定义；
>
> 一种颜色与补色差180度。

![image-20220215175734314](https://gitee.com/yi-junquan/image_gitee/raw/master/images/image-20220215175734314.png)

HSV模型对应画家的配色的方法：用改变色浓和色深的方法从某种纯色获得不同色调的颜色